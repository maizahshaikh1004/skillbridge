<!-- pages/recommendations.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SkillBridge ‚Äì Personalized Recommendations</title>

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="../css/style.css" />

  <!-- Google Fonts for Devanagari -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Noto+Sans+Devanagari:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    body { font-family: 'Poppins', 'Noto Sans Devanagari', sans-serif; }
    .devanagari { font-family: 'Noto Sans Devanagari', sans-serif; }
  </style>
</head>

<body class="bg-gradient-to-br from-purple-50 via-pink-50 to-indigo-50 min-h-screen py-8">

  <!-- Header -->
  <header class="bg-white shadow-md py-6 mb-8">
    <div class="container mx-auto px-4 text-center">
      <img src="../assets/logo.png" alt="SkillBridge Logo" class="h-16 mx-auto mb-4" />
      <h1 id="pageTitle" class="text-4xl font-bold text-gray-800">Personalized Recommendations</h1>
      <p id="pageSubtitle" class="text-xl text-gray-600 mt-3">Learn from your mistakes and get stronger!</p>
    </div>
  </header>

  <main class="container mx-auto px-4 max-w-5xl">

    <!-- Loading State -->
    <div id="loadingState" class="text-center py-20">
      <div class="animate-spin rounded-full h-16 w-16 border-b-4 border-purple-600 mx-auto"></div>
      <p class="mt-6 text-2xl text-gray-700 devanagari">Generating your personalized recommendations...</p>
    </div>

    <!-- Recommendations Content (hidden initially) -->
    <div id="recommendationsContent" class="hidden space-y-12">

      <!-- Overall Summary -->
      <div class="bg-white rounded-3xl shadow-xl p-8">
        <h2 id="summaryTitle" class="text-3xl font-bold text-indigo-700 mb-4 devanagari">Your Performance Summary</h2>
        <p id="summaryText" class="text-lg text-gray-700 leading-relaxed devanagari"></p>
      </div>

      <!-- Weak Topics Explanations -->
      <div id="explanationsSection">
        <h2 id="explanationsTitle" class="text-3xl font-bold text-purple-700 mb-8 text-center devanagari">Detailed Explanations & Tips</h2>
        <div id="explanationsContainer" class="grid md:grid-cols-1 lg:grid-cols-2 gap-8">
          <!-- Explanations injected by JS -->
        </div>
      </div>

      <!-- Practice Questions -->
      <div id="practiceSection" class="bg-gradient-to-r from-indigo-100 to-purple-100 rounded-3xl p-10">
        <h2 id="practiceTitle" class="text-3xl font-bold text-indigo-800 mb-8 text-center devanagari">Extra Practice Questions</h2>
        <div id="practiceContainer" class="space-y-8"></div>
      </div>

      <!-- Final Motivation -->
      <div class="text-center bg-white rounded-3xl shadow-xl p-10">
        <p id="motivationText" class="text-2xl font-semibold text-gray-800 devanagari"></p>
        <div class="mt-8">
          <a href="subjects.html" class="inline-block bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-10 py-4 rounded-full text-xl font-bold hover:shadow-2xl transform hover:-translate-y-1 transition-all">
            Practice Again
          </a>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="text-center text-gray-500 mt-16 text-sm">
    Made with ‚ù§Ô∏è for Maharashtra Board Students | Hackathon 2025
  </footer>

  <script src="../js/main.js"></script>
  <script>
    // Translations
    const translations = {
      en: {
        pageTitle: "Personalized Recommendations",
        pageSubtitle: "Learn from your mistakes and get stronger!",
        loading: "Generating your personalized recommendations...",
        summaryTitle: "Your Performance Summary",
        summaryGood: "Excellent work! You have a strong grasp of the material. Here are a few advanced tips to master it completely.",
        summaryAverage: "Good effort! You've understood many concepts, but there are a few areas where focused practice will help you improve quickly.",
        summaryNeedsWork: "Great start! Let's focus on the topics below. With a little practice, you'll master them in no time!",
        explanationsTitle: "Detailed Explanations & Tips",
        practiceTitle: "Extra Practice Questions",
        motivation: "Keep practicing ‚Äì you're on your way to becoming a pro! üöÄ",
        tipPrefix: "Tip:",
        generatedByAI: "Powered by AI"
      },
      hi: {
        pageTitle: "‡§µ‡•à‡§Ø‡§ï‡•ç‡§§‡§ø‡§ï ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•á‡§Ç",
        pageSubtitle: "‡§Ö‡§™‡§®‡•Ä ‡§ó‡§≤‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§∏‡•á ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§¨‡§®‡•á‡§Ç!",
        loading: "‡§Ü‡§™‡§ï‡•Ä ‡§µ‡•à‡§Ø‡§ï‡•ç‡§§‡§ø‡§ï ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•á‡§Ç ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡•Ä ‡§ú‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à‡§Ç...",
        summaryTitle: "‡§Ü‡§™‡§ï‡•á ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§® ‡§ï‡§æ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂",
        summaryGood: "‡§∂‡§æ‡§®‡§¶‡§æ‡§∞ ‡§ï‡§æ‡§Æ! ‡§Ü‡§™‡§ï‡•ã ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•Ä ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§∏‡§Æ‡§ù ‡§π‡•à‡•§ ‡§Ø‡§π‡§æ‡§Ç ‡§ï‡•Å‡§õ ‡§â‡§®‡•ç‡§®‡§§ ‡§ü‡§ø‡§™‡•ç‡§∏ ‡§π‡•à‡§Ç ‡§ú‡§ø‡§®‡§∏‡•á ‡§Ü‡§™ ‡§á‡§∏‡•á ‡§™‡•Ç‡§∞‡•Ä ‡§§‡§∞‡§π ‡§Æ‡§π‡§æ‡§∞‡§§ ‡§π‡§æ‡§∏‡§ø‡§≤ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§",
        summaryAverage: "‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏! ‡§Ü‡§™‡§®‡•á ‡§ï‡§à ‡§Ö‡§µ‡§ß‡§æ‡§∞‡§£‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§∏‡§Æ‡§ù ‡§≤‡§ø‡§Ø‡§æ ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® ‡§ï‡•Å‡§õ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§ê‡§∏‡•á ‡§π‡•à‡§Ç ‡§ú‡§π‡§æ‡§Ç ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§§ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§∏‡•á ‡§Ü‡§™ ‡§ú‡§≤‡•ç‡§¶‡•Ä ‡§∏‡•Å‡§ß‡§æ‡§∞ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§",
        summaryNeedsWork: "‡§∂‡§æ‡§®‡§¶‡§æ‡§∞ ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§! ‡§Ü‡§á‡§è ‡§®‡•Ä‡§ö‡•á ‡§¶‡§ø‡§è ‡§ó‡§è ‡§µ‡§ø‡§∑‡§Ø‡•ã‡§Ç ‡§™‡§∞ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç‡•§ ‡§•‡•ã‡§°‡§º‡•á ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§∏‡•á ‡§Ü‡§™ ‡§á‡§®‡•ç‡§π‡•á‡§Ç ‡§ú‡§≤‡•ç‡§¶‡•Ä ‡§Æ‡§π‡§æ‡§∞‡§§ ‡§π‡§æ‡§∏‡§ø‡§≤ ‡§ï‡§∞ ‡§≤‡•á‡§Ç‡§ó‡•á!",
        explanationsTitle: "‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ ‡§î‡§∞ ‡§∏‡•Å‡§ù‡§æ‡§µ",
        practiceTitle: "‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®",
        motivation: "‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç ‚Äì ‡§Ü‡§™ ‡§™‡•ç‡§∞‡•ã ‡§¨‡§®‡§®‡•á ‡§ï‡•Ä ‡§∞‡§æ‡§π ‡§™‡§∞ ‡§π‡•à‡§Ç! üöÄ",
        tipPrefix: "‡§∏‡•Å‡§ù‡§æ‡§µ:",
        generatedByAI: "AI ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§"
      },
      mr: {
        pageTitle: "‡§µ‡•à‡§Ø‡§ï‡•ç‡§§‡§ø‡§ï ‡§∂‡§ø‡§´‡§æ‡§∞‡§∂‡•Ä",
        pageSubtitle: "‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§ö‡•Å‡§ï‡§æ ‡§∂‡§ø‡§ï‡§æ ‡§Ü‡§£‡§ø ‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§µ‡•ç‡§π‡§æ!",
        loading: "‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§µ‡•à‡§Ø‡§ï‡•ç‡§§‡§ø‡§ï ‡§∂‡§ø‡§´‡§æ‡§∞‡§∂‡•Ä ‡§§‡§Ø‡§æ‡§∞ ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á‡§§...",
        summaryTitle: "‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§ï‡§æ‡§Æ‡§ó‡§ø‡§∞‡•Ä‡§ö‡§æ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂",
        summaryGood: "‡§â‡§§‡•ç‡§§‡§Æ ‡§ï‡§æ‡§Æ! ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§≤‡§æ ‡§∏‡§æ‡§π‡§ø‡§§‡•ç‡§Ø‡§æ‡§ö‡•Ä ‡§ö‡§æ‡§Ç‡§ó‡§≤‡•Ä ‡§∏‡§Æ‡§ú ‡§Ü‡§π‡•á. ‡§™‡•Ç‡§∞‡•ç‡§£‡§™‡§£‡•á ‡§™‡•ç‡§∞‡§≠‡•Å‡§§‡•ç‡§µ ‡§Æ‡§ø‡§≥‡§µ‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§ï‡§æ‡§π‡•Ä ‡§™‡•ç‡§∞‡§ó‡§§ ‡§ü‡§ø‡§™‡§æ ‡§Ø‡•á‡§•‡•á ‡§Ü‡§π‡•á‡§§‡•§",
        summaryAverage: "‡§õ‡§æ‡§® ‡§™‡•ç‡§∞‡§Ø‡§§‡•ç‡§®! ‡§§‡•Å‡§Æ‡•ç‡§π‡•Ä ‡§¨‡§∞‡•á‡§ö ‡§∏‡§Ç‡§ï‡§≤‡•ç‡§™‡§®‡§æ ‡§∏‡§Æ‡§ú‡•Ç‡§® ‡§ò‡•á‡§§‡§≤‡•ç‡§Ø‡§æ ‡§Ü‡§π‡•á‡§§, ‡§™‡§∞‡§Ç‡§§‡•Å ‡§ï‡§æ‡§π‡•Ä ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡•á ‡§Ö‡§∂‡•Ä ‡§Ü‡§π‡•á‡§§ ‡§ú‡§ø‡§•‡•á ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§§ ‡§∏‡§∞‡§æ‡§µ ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§≤‡§æ ‡§≤‡§µ‡§ï‡§∞ ‡§∏‡•Å‡§ß‡§æ‡§∞‡§£‡•ç‡§Ø‡§æ‡§∏ ‡§Æ‡§¶‡§§ ‡§ï‡§∞‡•á‡§≤‡•§",
        summaryNeedsWork: "‡§õ‡§æ‡§® ‡§∏‡•Å‡§∞‡•Å‡§µ‡§æ‡§§! ‡§ñ‡§æ‡§≤‡•Ä‡§≤ ‡§µ‡§ø‡§∑‡§Ø‡§æ‡§Ç‡§µ‡§∞ ‡§≤‡§ï‡•ç‡§∑ ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡•Ç‡§Ø‡§æ‡•§ ‡§•‡•ã‡§°‡•ç‡§Ø‡§æ ‡§∏‡§∞‡§æ‡§µ‡§æ‡§®‡•á ‡§§‡•Å‡§Æ‡•ç‡§π‡•Ä ‡§§‡•ç‡§Ø‡§æ‡§§ ‡§™‡•ç‡§∞‡§≠‡•Å‡§§‡•ç‡§µ ‡§Æ‡§ø‡§≥‡§µ‡§æ‡§≤!",
        explanationsTitle: "‡§§‡§™‡§∂‡•Ä‡§≤‡§µ‡§æ‡§∞ ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü‡•Ä‡§ï‡§∞‡§£ ‡§Ü‡§£‡§ø ‡§ü‡§ø‡§™‡§æ",
        practiceTitle: "‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§∏‡§∞‡§æ‡§µ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®",
        motivation: "‡§∏‡§∞‡§æ‡§µ ‡§∏‡•Å‡§∞‡•Ç ‡§†‡•á‡§µ‡§æ ‚Äì ‡§§‡•Å‡§Æ‡•ç‡§π‡•Ä ‡§™‡•ç‡§∞‡•ã ‡§π‡•ã‡§£‡•ç‡§Ø‡§æ‡§ö‡•ç‡§Ø‡§æ ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§æ‡§µ‡§∞ ‡§Ü‡§π‡§æ‡§§! üöÄ",
        tipPrefix: "‡§ü‡§ø‡§™:",
        generatedByAI: "AI ‡§¶‡•ç‡§µ‡§æ‡§∞‡•á ‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§"
      }
    };

    const lang = localStorage.getItem('userLanguage') || 'en';
    const t = translations[lang];

    // Update static text
    document.getElementById('pageTitle').textContent = t.pageTitle;
    document.getElementById('pageSubtitle').textContent = t.pageSubtitle;
    document.querySelector('#loadingState p').textContent = t.loading;

    // Retrieve quiz data
    const score = parseInt(localStorage.getItem('lastScore') || '0');
    const total = parseInt(localStorage.getItem('lastTotal') || '0');
    const questions = JSON.parse(localStorage.getItem('lastQuestions') || '[]');
    const userAnswers = JSON.parse(localStorage.getItem('lastAnswers') || '[]');

    const percentage = total > 0 ? Math.round((score / total) * 100) : 0;

    // Determine summary message
    let summaryText;
    if (percentage >= 80) summaryText = t.summaryGood;
    else if (percentage >= 50) summaryText = t.summaryAverage;
    else summaryText = t.summaryNeedsWork;

    document.getElementById('summaryText').textContent = summaryText;

    // Find weak questions
    const weakQuestions = questions
      .map((q, i) => ({ question: q, userAns: userAnswers[i], correctAns: q.answer, index: i }))
      .filter(item => item.userAns !== item.correctAns);

    // Generate Mock AI Recommendations (since no real Gemini API in frontend demo)
    // In a real app, you'd call your backend here that uses Gemini
    setTimeout(() => {
      document.getElementById('loadingState').classList.add('hidden');
      document.getElementById('recommendationsContent').classList.remove('hidden');

      const explanationsContainer = document.getElementById('explanationsContainer');
      const practiceContainer = document.getElementById('practiceContainer');

      if (weakQuestions.length === 0) {
        explanationsContainer.innerHTML = `
          <div class="col-span-2 text-center py-16">
            <div class="text-6xl mb-4">üéâ</div>
            <p class="text-2xl font-bold text-green-600 devanagari">Perfect Score! No weak areas detected.</p>
            <p class="text-lg text-gray-600 mt-4 devanagari">You're ready for advanced challenges!</p>
          </div>`;
      } else {
        weakQuestions.forEach((item, idx) => {
          const q = item.question;

          // Mock Explanation Card
          const expCard = document.createElement('div');
          expCard.className = "bg-gradient-to-br from-purple-50 to-indigo-50 rounded-2xl p-8 shadow-lg";
          expCard.innerHTML = `
            <h3 class="text-xl font-bold text-purple-800 mb-4 devanagari">Topic ${idx + 1}: ${q.question.substring(0, 80)}...</h3>
            <p class="text-gray-700 leading-relaxed devanagari mb-4">
              <strong>Why this is important:</strong> This concept builds the foundation for advanced topics in the subject.
            </p>
            <p class="text-gray-700 leading-relaxed devanagari mb-4">
              <strong>${t.tipPrefix}</strong> Focus on understanding the core principle first. Try drawing diagrams or teaching it to someone else.
            </p>
            <p class="text-sm text-gray-500 italic">${t.generatedByAI}</p>
          `;
          explanationsContainer.appendChild(expCard);

          // Mock Practice Questions
          const practiceCard = document.createElement('div');
          practiceCard.className = "bg-white rounded-xl shadow-md p-6";
          practiceCard.innerHTML = `
            <p class="font-medium text-lg mb-4 devanagari">${idx + 1}. Which of the following is the correct approach for this concept?</p>
            <ul class="space-y-3">
              <li class="flex items-center"><span class="mr-3">A)</span> <span class="devanagari">Revise basic definitions</span></li>
              <li class="flex items-center"><span class="mr-3">B)</span> <span class="devanagari">Practice similar problems daily</span></li>
              <li class="flex items-center text-green-600 font-bold"><span class="mr-3">C)</span> <span class="devanagari">Both A and B (Correct)</span></li>
              <li class="flex items-center"><span class="mr-3">D)</span> <span class="devanagari">Skip and move ahead</span></li>
            </ul>
          `;
          practiceContainer.appendChild(practiceCard);
        });
      }

      // Update titles
      document.getElementById('summaryTitle').textContent = t.summaryTitle;
      document.getElementById('explanationsTitle').textContent = t.explanationsTitle;
      document.getElementById('practiceTitle').textContent = t.practiceTitle;
      document.getElementById('motivationText').textContent = t.motivation;

    }, 2000); // Simulate AI processing time for demo
  </script>
</body>
</html>